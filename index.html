<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://blog.cloudbce.com').hostname,
    root: '/',
    scheme: 'Pisces',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="悟已往之不谏 知来者之可追">
<meta property="og:url" content="https://blog.cloudbce.com/index.html">
<meta property="og:site_name" content="悟已往之不谏 知来者之可追">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Wang Yian">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.cloudbce.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>悟已往之不谏 知来者之可追</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">悟已往之不谏 知来者之可追</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>Tags<span class="badge">5</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>Categories<span class="badge">1</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives<span class="badge">14</span></a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2021/04/08/ios-wireshark/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/08/ios-wireshark/" class="post-title-link" itemprop="url">ios-wireshark</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-04-08 15:59:24 / Modified: 21:01:07" itemprop="dateCreated datePublished" datetime="2021-04-08T15:59:24+08:00">2021-04-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><font color='green'>wireshark抓ios包步骤:</font></p>
<ol>
<li><p>安装xcode</p>
</li>
<li><p>xcode创建一个空的工程</p>
</li>
<li><p>手机连电脑，手机上打开开发者模式</p>
</li>
<li><p>创建虚拟网卡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.rpmuxd.plist</span><br><span class="line">$ rvictl -s $序列号</span><br></pre></td></tr></table></figure>
</li>
<li><p>wireshark上过滤rvi网卡数据</p>
</li>
</ol>
<p>tcpdump抓包过滤rst</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;tcp[tcpflags] &amp; (tcp-rst) !=0&#x27;</span></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2021/02/18/QUIC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/18/QUIC/" class="post-title-link" itemprop="url">QUIC</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-02-18 16:12:58" itemprop="dateCreated datePublished" datetime="2021-02-18T16:12:58+08:00">2021-02-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-03-05 19:51:09" itemprop="dateModified" datetime="2021-03-05T19:51:09+08:00">2021-03-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://docs.google.com/document/d/1gY9-YNDNAB1eip-RTPbqphgySwSNSDHLq9D5Bty4FSU/edit">https://docs.google.com/document/d/1gY9-YNDNAB1eip-RTPbqphgySwSNSDHLq9D5Bty4FSU/edit</a></p>
<p>HTTP2.0解决了HTTP1.x的队首阻塞问题，并且对首部进行了压缩，下一步的优化则在于传输层。 因为在HTTP2.0中，单连接上如果有拥塞的话，则会对这个连接上的所有消息都有影响，TCP拥塞控制在内核层面，做升级是非常麻烦的事情， 对此，QUIC（Quick UDP Internet Connections) 应运而生。 </p>
<p>QUIC ~= HTTP2 + TLS + TCP，QUIC比较与HTTP2 + TLS + TCP, 有以下优势：</p>
<ul>
<li>低时延建连</li>
<li>改进的拥塞控制算法</li>
<li>前向纠错</li>
<li>连接迁移</li>
</ul>
<h3 id="Connection-Establishment"><a href="#Connection-Establishment" class="headerlink" title="Connection Establishment"></a>Connection Establishment</h3><p><a target="_blank" rel="noopener" href="https://docs.google.com/document/d/1g5nIXAIkN_Y-7XJW5K45IblHd_L2f5LTaDUDwvZ5L6g/edit">https://docs.google.com/document/d/1g5nIXAIkN_Y-7XJW5K45IblHd_L2f5LTaDUDwvZ5L6g/edit</a></p>
<ul>
<li>握手只需要0-RTT。 第1次QUIC建连的时候是需要1个RTT的，客户端发送一个Empty CHLO, 服务器回复REJ(证书、source address token信息等)， 下次建连的时候，CHLO则不是空的了，使用上一次缓存的证书信息。</li>
</ul>
<h3 id="Congestion-Control"><a href="#Congestion-Control" class="headerlink" title="Congestion Control"></a>Congestion Control</h3><p>可插拔的拥塞控制算法，重新实现了TCP Cubic…</p>
<h3 id="Multiplexing"><a href="#Multiplexing" class="headerlink" title="Multiplexing"></a>Multiplexing</h3><p>HTTP2在TCP层存在队首阻塞问题（head-of-line blocking), TCP连接上丢失了一个报文的话，则会阻塞这个连接上的所有消息。 而QUIC则能解决这个问题。</p>
<h3 id="Forward-Error-Correction"><a href="#Forward-Error-Correction" class="headerlink" title="Forward Error Correction"></a>Forward Error Correction</h3><p>丢失的存文，可以通过FEC Packet进行修复，这个是发送方可选的。</p>
<h3 id="Connection-Migration"><a href="#Connection-Migration" class="headerlink" title="Connection Migration"></a>Connection Migration</h3><p>QUIC连接是通过64位的Connection ID（随机生成）来唯一标识， TCP则是通过四元组来表示，因为相比较于TCP，IP地址发生变化（wifi-&gt;cellular…)，可以继续使用QUIC连接连接。</p>
<h2 id="HTTP-3"><a href="#HTTP-3" class="headerlink" title="HTTP 3"></a>HTTP 3</h2><ol>
<li><p>准备好docker</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -ti -p 443:443 -p 443:443&#x2F;udp -v &#x2F;Users&#x2F;wangguosheng01&#x2F;workspace:&#x2F;root&#x2F;workspace --name http3-test -d ubuntu &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>



</li>
</ol>
<ol start="2">
<li>nginx-quic 编译</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ apt-get update</span><br><span class="line">$ apt-get install build-essential</span><br><span class="line">$ apt-get install libssl-dev</span><br><span class="line">$ apt-get install zlib1g-dev</span><br><span class="line">$ .&#x2F;auto&#x2F;configure --with-debug --with-http_v3_module --with-cc-opt&#x3D;&quot;-I..&#x2F;boringssl&#x2F;include&quot; --with-ld-opt&#x3D;&quot;-L..&#x2F;boringssl&#x2F;build&#x2F;ssl  -L..&#x2F;boringssl&#x2F;build&#x2F;crypto&quot;  --with-pcre&#x3D;..&#x2F;pcre-8.33</span><br></pre></td></tr></table></figure>

<p>错误:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;auto&#x2F;configure: error: certain modules require OpenSSL QUIC support.</span><br><span class="line">You can either do not enable the modules, or install the OpenSSL library</span><br><span class="line">into the system, or build the OpenSSL library statically from the source</span><br><span class="line">with nginx by using --with-openssl&#x3D;&lt;path&gt; option</span><br></pre></td></tr></table></figure>

<p>需要先编译boringssl</p>
<p>$ apt-get install cmake<br>$ apt-get install golang-go</p>
<p>设置代理<br>$ go env -w GOPROXY=<a target="_blank" rel="noopener" href="https://goproxy.cn,direct">https://goproxy.cn,direct</a><br>$ go env -w GO111MODULE=on</p>
<p>$ cd boringssl; mkdir build; cmake ..; make</p>
<p>继续编译nginx-quic<br>$ ./auto/configure –with-debug –with-http_v3_module –with-cc-opt=”-I../boringssl/include” –with-ld-opt=”-L../boringssl/build/ssl  -L../boringssl/build/crypto”  –with-pcre=../pcre-8.33<br>$ make -j4; make install</p>
<ol start="3">
<li>运行quic<br><a target="_blank" rel="noopener" href="https://freessl.cn/">https://freessl.cn/</a> 上申请个证书</li>
</ol>
<ol start="4">
<li>启动quic-nginx</li>
<li>启动chrome<br>/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome –enable-quic –quic-version=h3-29<br>firefox则要使用nightly版本，about:config里面将http3启动（默认是打开的）</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2020/11/19/profiler/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/19/profiler/" class="post-title-link" itemprop="url">Profiler</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-11-19 21:56:11" itemprop="dateCreated datePublished" datetime="2020-11-19T21:56:11+08:00">2020-11-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-25 20:43:13" itemprop="dateModified" datetime="2020-11-25T20:43:13+08:00">2020-11-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="tcmalloc"><a href="#tcmalloc" class="headerlink" title="tcmalloc"></a>tcmalloc</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/51433881">tcmalloc原理分析</a></p>
<h2 id="gperftools"><a href="#gperftools" class="headerlink" title="gperftools"></a>gperftools</h2><p><a target="_blank" rel="noopener" href="https://gperftools.github.io/gperftools/">gperftools</a></p>
<p>内存分析的有2个，heap-profiler和heap-check, heap-check内部实现使用的是heap-profiler。</p>
<p>gperftools需要安装:</p>
<ul>
<li>libunwind</li>
<li>libgperftools</li>
<li>ghostscript</li>
<li>graphviz</li>
</ul>
<p>gcc/g++编译的时候，链接:  -ltcmalloc -lprofiler。 profiler是基于tcmalloc实现的，因此tcmalloc是必须。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/11/19/profiler/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2020/11/16/aes-cbc-256/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/16/aes-cbc-256/" class="post-title-link" itemprop="url">aes-cbc-256</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-11-16 23:05:56" itemprop="dateCreated datePublished" datetime="2020-11-16T23:05:56+08:00">2020-11-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-19 22:35:42" itemprop="dateModified" datetime="2020-11-19T22:35:42+08:00">2020-11-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>明文分组加密</p>
<p>AES - Advance Encryption Standard<br>256 - 密钥长度<br>CBC - Cipher Block Chaining (将明文切为若干段，每一段与初始块或者上一段密文进行或操作后，再与密钥进行加密)</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/11/16/aes-cbc-256/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2020/10/31/%E6%88%91%E7%9A%84%E5%AA%92%E4%BD%93%E6%88%90%E9%95%BF%E6%97%A5%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/31/%E6%88%91%E7%9A%84%E5%AA%92%E4%BD%93%E6%88%90%E9%95%BF%E6%97%A5%E8%AE%B0/" class="post-title-link" itemprop="url">我的媒体成长日记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-31 10:45:51" itemprop="dateCreated datePublished" datetime="2020-10-31T10:45:51+08:00">2020-10-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-12-05 20:57:01" itemprop="dateModified" datetime="2020-12-05T20:57:01+08:00">2020-12-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>10月最后一天，在家里的书桌上，开启了这篇成长日记。 媒体技术一开始并不觉得多好玩， 但是慢慢的接触了点后，发现还是挺有趣的，而媒体技术本身也没有系统的教程可以学习，目前我只能在工作中摸索，一天天的积累，希望这篇成长日记能够坚持写下去, 在媒体领域能有所耕耘。 </p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/10/31/%E6%88%91%E7%9A%84%E5%AA%92%E4%BD%93%E6%88%90%E9%95%BF%E6%97%A5%E8%AE%B0/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2020/10/24/book-list/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/24/book-list/" class="post-title-link" itemprop="url">我的书单</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-24 15:01:44" itemprop="dateCreated datePublished" datetime="2020-10-24T15:01:44+08:00">2020-10-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-05-10 16:24:47" itemprop="dateModified" datetime="2021-05-10T16:24:47+08:00">2021-05-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="我的书单"><a href="#我的书单" class="headerlink" title="我的书单"></a>我的书单</h3><table>
<thead>
<tr>
<th align="left">时间</th>
<th align="left">书名</th>
<th align="left">作者</th>
</tr>
</thead>
<tbody><tr>
<td align="left">2020.10.24</td>
<td align="left">为什么精英都是时间控</td>
<td align="left">桦泽紫苑</td>
</tr>
<tr>
<td align="left">2020.10.27</td>
<td align="left">为什么精英这样用脑不会累</td>
<td align="left">桦泽紫苑</td>
</tr>
<tr>
<td align="left">2020.10.31</td>
<td align="left">Linux多线程服务端编程 使用muduo C++网络库</td>
<td align="left">陈硕</td>
</tr>
<tr>
<td align="left">2020.11.03</td>
<td align="left">为什么精英沟通最高效</td>
<td align="left">桦泽紫苑</td>
</tr>
<tr>
<td align="left">2020.11.15</td>
<td align="left">人体简史</td>
<td align="left">比尔 布莱森</td>
</tr>
<tr>
<td align="left">2020.12.05</td>
<td align="left">第三极的馈赠</td>
<td align="left">乔治 夏勒</td>
</tr>
<tr>
<td align="left">2020.12.26</td>
<td align="left">我在天堂那五年</td>
<td align="left">约翰 施利姆</td>
</tr>
<tr>
<td align="left">2020.12.29</td>
<td align="left">web性能权威指南</td>
<td align="left">Ilya Grigorik</td>
</tr>
<tr>
<td align="left">2021.01.02</td>
<td align="left">人间须尽欢</td>
<td align="left">高军</td>
</tr>
<tr>
<td align="left">2021.01.20</td>
<td align="left">富爸爸穷爸爸</td>
<td align="left">罗伯特清崎</td>
</tr>
<tr>
<td align="left">2021.02.09</td>
<td align="left">穷查理宝典</td>
<td align="left">比特考夫曼</td>
</tr>
<tr>
<td align="left">2021.02.23</td>
<td align="left">影响力</td>
<td align="left">罗伯特西奥迪</td>
</tr>
<tr>
<td align="left">2021.03.05</td>
<td align="left">《本杰明 - 富兰克林自传》</td>
<td align="left">本杰明 - 富兰克林</td>
</tr>
<tr>
<td align="left">2021.05.10</td>
<td align="left">巴菲特传</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">TODO</td>
<td align="left">论可计算数 图灵与现代计算的诞生</td>
<td align="left">克里斯-伯恩哈特</td>
</tr>
<tr>
<td align="left">TODO</td>
<td align="left"><a target="_blank" rel="noopener" href="https://item.jd.com/12148832.html">https://item.jd.com/12148832.html</a> 图解算法</td>
<td align="left">巴尔加瓦（美）</td>
</tr>
</tbody></table>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/10/24/book-list/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2020/09/30/Muduo/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/30/Muduo/" class="post-title-link" itemprop="url">Muduo</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-30 18:13:40" itemprop="dateCreated datePublished" datetime="2020-09-30T18:13:40+08:00">2020-09-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-31 10:10:40" itemprop="dateModified" datetime="2020-10-31T10:10:40+08:00">2020-10-31</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="/images/mudo-event.drawio.svg"></img></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2020/09/29/etcd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/29/etcd/" class="post-title-link" itemprop="url">etcd</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-09-29 19:22:42 / Modified: 19:24:48" itemprop="dateCreated datePublished" datetime="2020-09-29T19:22:42+08:00">2020-09-29</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="RAFT"><a href="#RAFT" class="headerlink" title="RAFT"></a>RAFT</h2><p><a target="_blank" rel="noopener" href="http://thesecretlivesofdata.com/raft/">http://thesecretlivesofdata.com/raft/</a></p>
<p><a target="_blank" rel="noopener" href="https://techthoughts.typepad.com/managing_computers/2007/10/split-brain-quo.html">https://techthoughts.typepad.com/managing_computers/2007/10/split-brain-quo.html</a></p>
<h2 id="TBD"><a href="#TBD" class="headerlink" title="TBD"></a>TBD</h2><p><a target="_blank" rel="noopener" href="https://etcd.io/docs/v3.4.0/demo/">https://etcd.io/docs/v3.4.0/demo/</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2020/09/29/%E5%AA%92%E4%BD%93%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/29/%E5%AA%92%E4%BD%93%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">媒体基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-29 19:12:02" itemprop="dateCreated datePublished" datetime="2020-09-29T19:12:02+08:00">2020-09-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-19 22:36:20" itemprop="dateModified" datetime="2020-11-19T22:36:20+08:00">2020-11-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/leixiaohua1020">https://blog.csdn.net/leixiaohua1020</a></p>
<h3 id="什么是视频"><a href="#什么是视频" class="headerlink" title="什么是视频"></a>什么是视频</h3><p>视频是一种有结构的数据，用工程的语言解释，我们可以把视频剖析成如下结构:</p>
<p><img src="/images/video-form.png"></img></p>
<p>内容元素 ( Content )</p>
<ul>
<li>图像 ( Image )</li>
<li>音频 ( Audio )</li>
<li>元信息 ( Metadata ) </li>
</ul>
<p>编码格式 ( Codec )</p>
<ul>
<li>Video : H.264，H.265, …</li>
<li>Audio : AAC， HE-AAC, …</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/09/29/%E5%AA%92%E4%BD%93%E5%9F%BA%E7%A1%80/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.cloudbce.com/2020/04/08/epoll/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Wang Yian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="悟已往之不谏 知来者之可追">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/08/epoll/" class="post-title-link" itemprop="url">epoll</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-04-08 10:44:10 / Modified: 15:25:04" itemprop="dateCreated datePublished" datetime="2020-04-08T10:44:10+08:00">2020-04-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="what-is-epoll"><a href="#what-is-epoll" class="headerlink" title="what is epoll"></a>what is epoll</h2><p><a target="_blank" rel="noopener" href="https://lwn.net/Articles/14168/">sys_epoll - making poll fast</a></p>
<p>[Posted October 30, 2002 by corbet]</p>
<p>The classic Unix way to wait for I/O events on multiple file descriptors is with the select() and poll() system calls. When a process invokes one of those calls, the kernel goes through the list of interesting file descriptors, checks to see if non-blocking I/O is available on any of them, and adds the calling process to a wait queue for each file descriptor that would block. This implementation works reasonably well when the number of file descriptors is small. But if a process is managing thousands of file descriptors, the select() and poll() calls must check every single one of them, and add the calling process to thousands of wait queues. For every single call. Needless to say, this approach does not scale very well.<br>Davide Libenzi and others have been working for some time on a new approach to polling that would work for thousands of files. It was originally implemented as a special device (/dev/epoll), but, on request from Linus, the new scheme was turned into a new set of epoll() system calls. These calls work in a very different way. Every call to select() or poll() is a separate event; the data structures must be set up and torn down every time. epoll, instead, requires the application to build a persistent (across calls) data structure in kernel space first. The application starts by creating a special epoll file descriptor:</p>
<pre><code>epfd = epoll_create(int maxfds);</code></pre><p>The maxfds parameter is the maximum number of file descriptors that the process expects to manage. The return value is a file descriptor to be used with the other epoll calls; it should be shut down with close() when it is no longer needed.</p>
<p>Each file descriptor to be managed must be added to the special epoll descriptor with:</p>
<pre><code>int epoll_ctl(int epfd, int op, int fd, unsigned int events);</code></pre><p>The op parameter specifies the operation to be performed (add, change, or remove the given file descriptor fd), and events is a mask of events of interest to the process.</p>
<p>Once everything has been set up, the process can sit back and wait until there is something for it to do:</p>
<pre><code>int epoll_wait(int epfd, struct pollfd const **events, int timeout); </code></pre><p>The return value is the number of events (i.e. readable or writeable file descriptors) that epoll_wait() has found.</p>
<p>These system calls have been shown, through heavy benchmarking, to scale in constant time up to unbelievable numbers of file descriptors (some graphs can be found on this page). The persistent data structure built around the epoll file descriptor is one of the reasons for this scalability: there is no need to set it up and tear it down for every epoll_wait() call. The other half of the story is in how epoll_wait() finds the readable or writeable file descriptors. Rather than polling each file descriptor (and adding itself to wait queues), the epoll mechanism adds a callback structure onto the struct file associated with each file descriptor. When a file descriptor becomes readable or writeable, its callback(s) are called, and processes using epoll_wait() can be notified directly. So an epoll_wait() call never needs to make a pass over the list of file descriptors it is watching.</p>
<h2 id="FIFO-PIPE-amp-EPOLL"><a href="#FIFO-PIPE-amp-EPOLL" class="headerlink" title="FIFO/PIPE &amp; EPOLL"></a>FIFO/PIPE &amp; EPOLL</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/epoll.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_EVENTS 10</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BUF_SIZE 128</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> rc = mkfifo(msg_queue.c_str(), <span class="number">0666</span>);</span><br><span class="line">    <span class="keyword">if</span> (rc &lt; <span class="number">0</span> &amp;&amp; errno != EEXIST) &#123;</span><br><span class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">&quot;error %m&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> rc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> fd = open(msg_queue.c_str(), O_RDONLY | O_NONBLOCK);</span><br><span class="line">    fcntl(fd, F_SETPIPE_SZ, <span class="number">4</span> * <span class="number">16</span> * sysconf(_SC_PAGESIZE));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> epoll_fd = epoll_create(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span> (epoll_fd == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;epoll_create&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">epoll_event</span> <span class="title">ev</span>, <span class="title">events</span>[<span class="title">MAX_EVENTS</span>];</span></span><br><span class="line">    ev.events = EPOLLIN | EPOLLET;</span><br><span class="line">    ev.data.fd = fd;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (epoll_ctl(epoll_fd, EPOLL_CTL_ADD, fd, &amp;ev) == <span class="number">-1</span>) &#123;</span><br><span class="line">        perror(<span class="string">&quot;epoll_ctl: listen_sock&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> buf[BUF_SIZE];</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> line;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> nfds = epoll_wait(epoll_fd, events, MAX_EVENTS, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span> (nfds == <span class="number">-1</span>) &#123;</span><br><span class="line">            perror(<span class="string">&quot;epoll_pwait&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(EXIT_FAILURE);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; n &lt; nfds; ++n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (events[n].data.fd == fd) &#123;</span><br><span class="line">                <span class="keyword">bool</span> done = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">while</span> (!done) &#123;</span><br><span class="line">                    <span class="keyword">int</span> bytes = read(fd, buf, BUF_SIZE);</span><br><span class="line">                    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;bytes = &quot;</span> &lt;&lt; bytes &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bytes; ++i) &#123;</span><br><span class="line">                        line.append(buf + i, <span class="number">1</span>);</span><br><span class="line">                        <span class="keyword">if</span> (buf[i] == <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line">                            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\t&quot;</span> &lt;&lt; line;</span><br><span class="line">                            line.clear();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (errno == EAGAIN) &#123;</span><br><span class="line">                        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;\tEAGAIN GOT. &quot;</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (bytes == <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>为了一次性可以将buf充满，一次read调用尽可能读取尽量多的数据，调用fcntl设置FIFO的容量。</li>
<li>将fd设置为非阻塞的， fd是否为阻塞的是由回调决定的。 单线程读取的话，应该设置为非阻塞的， 避免一个fd的read的阻塞影响其他的fd。  对于复杂的网络IO，需要再学习下开源代码的实现。</li>
<li>EAGAIN.  表示buffer已经读完了，此时可以跳出回调，等待下一次事件触发。</li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000018364969">https://segmentfault.com/a/1190000018364969</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Wang Yian</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/pianzhoujun" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;pianzhoujun" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wang Yian</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v5.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.6.0
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>
















  

  

</body>
</html>
